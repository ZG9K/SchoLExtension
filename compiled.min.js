// 
// Random SchoL improvements that make it better maybe?
// by Zac McWilliam and Sebastien Taylor
//         ____
//   _,.-'`_ o `;__,
//    _.-'` '---'  '
//
// Dark mode made by Max Bentley, Yuma Soerianto, and Sebastien Taylor
//         _
//     ___(.)<
//     \____)
// 

var coreCSSDom,themeCSSDom;const REGEXP=/\(([^)]+)\)/,REGEXP2=/\[([^)]+)\]/,TIMETABLE_WHITELIST=["Period 1","Period 2","Period 3","Period 4","Period 5"],SHOW_FEEDBACKS=["(00","[00","(01","[01","(02","[02","(03","[03","(04","[04","(05","[05","(06","[06","(12","[12"],THEME_API="https://apps.stmichaels.vic.edu.au/scholext",REMOTE_API="/modules/remote/"+btoa("https://apps.stmichaels.vic.edu.au/scholext/auth")+"/window",ACHIEVEMENT_IMG="/storage/image.php?hash=82df5e189a863cb13e2e988daa1c7098ef4aa9e1",VALID_PRONOUNS={hehim:"He/Him",sheher:"She/Her",theythem:"They/Them",other:"Ask Me"},IMAGE_TYPES=["image/png","image/gif","image/bmp","image/jpeg"],CORE_CSS_URL="https://services.stmichaels.vic.edu.au/_dmode/darkmode.css",THEMES_CSS_URL="https://api.onedrive.com/v1.0/shares/s!Ai0PkvhmurwZge_4fiSBxkmJaiRsF_I/root/content",DEFAULT_CONFIG={theme:{},themedefault:{},darkmodetheme:"light",settings:{colourduework:1,compacttimetable:1},pronouns:{selected:[],show:[1,1,1]},updated:0,version:2};let PTVDepatureUpdate=!0,extConfigSvr,extConfig;const RED=.2126,GREEN=.7152,BLUE=.0722,GAMMA=2.4;function getRgbLuminance(t,o,n){var r=[t,o,n].map(t=>(t/=255)<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4));return .2126*r[0]+.7152*r[1]+.0722*r[2]}function getRgbContrast(t,o){var n=getRgbLuminance(...t),r=getRgbLuminance(...o);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}let themeApplied=!1;function loadTextFileAjaxSync(t,o){var n=new XMLHttpRequest;return n.open("GET",t,!1),null!=o&&n.overrideMimeType&&n.overrideMimeType(o),n.send(),200==n.status&&4==n.readyState?n.responseText:null}function loadTheme(t,o){if(darkMode=o,"defaults"===o&&(darkMode=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),void 0!=coreCSSDom&&(coreCSSDom.remove(),coreCSSDom=void 0),"original"===t&&"light"===o){console.log("No theme being loaded.");return}(coreCSSDom=document.createElement("link")).rel="stylesheet",coreCSSDom.href="https://services.stmichaels.vic.edu.au/_dmode/darkmode.css",coreCSSDom.id="darkmode-core",(document.head||document.body).appendChild(coreCSSDom);let n=JSON.parse(loadTextFileAjaxSync("https://api.onedrive.com/v1.0/shares/s!Ai0PkvhmurwZge_4fiSBxkmJaiRsF_I/root/content","application/json")),r=n.themes[o][t],l=document.createElement("style");l.textContent=r,l.id="darkmode-theme",(document.head||document.body).appendChild(l),themeApplied=!0}function contrastCheck(){themeCSSDom.onload=t=>{let o=[0,0,38];document.querySelectorAll('span:not([style*="color:#000"]):not(td[style*="background-color"] span):not(span[style*="background-color"] > span):not(div[style*="background-color"] *)').forEach(t=>{let n=window.getComputedStyle(t).color.replace(/[^\d,]/g,"").split(",").slice(0,3);3===n.length&&4.5>getRgbContrast(o,n)&&(t.style.color=`rgb(${255-n[0]},${255-n[1]},${255-n[2]})`)}),document.querySelectorAll('span[style*="background-color"]').forEach(t=>{let o=window.getComputedStyle(t).color.replace(/[^\d,]/g,"").split(",").slice(0,3),n=window.getComputedStyle(t).backgroundColor.replace(/[^\d,]/g,"").split(",").slice(0,3);3===o.length&&4.5>getRgbContrast(n,o)&&(console.log(o),t.style.cssText+=`color:rgb(${255-o[0]},${255-o[1]},${255-o[2]}) !important;`,console.log(t.style.color))})}}if(!(void 0!=localStorage.getItem("disableQOL")&&"undefined"==typeof forceEnableQOL)&&null!==localStorage.getItem("extConfig"))try{let t=JSON.parse(localStorage.getItem("extConfig"));t.darkmodeMode&&loadTheme(t.darkmodeTheme,t.darkmodeMode)}catch(o){console.warn("[SCHOLEXT] Sorry if there was a light mode flash! This is due to settings requiring a sync with the server. =â€¢= \uD83D\uDC24"),console.warn(o)}async function load(){if(void 0!=localStorage.getItem("disableQOL")&&"undefined"==typeof forceEnableQOL||"undefined"==typeof schoolboxUser)return;schoolboxUser.id!=localStorage.getItem("lastUser")&&(localStorage.removeItem("extConfig"),localStorage.removeItem("lastThemeCache"),localStorage.removeItem("userToken"),localStorage.setItem("lastUser",schoolboxUser.id));let t=!1;null!==localStorage.getItem("skipServerLoading")&&(localStorage.getItem("skipServerLoading")>Date.now()?t=!0:localStorage.removeItem("skipServerLoading"),(async()=>{try{await getConfig(),console.warn("[SCHOLEXT] Server is back online! Everything will be loaded as normal with the next page load."),localStorage.removeItem("skipServerLoading")}catch(t){"Network error"===t.message&&console.warn(`[SCHOLEXT] Server is still offline, skipping forced server loading for ${Math.round((localStorage.getItem("skipServerLoading")-Date.now())/1e3/60)} minutes`)}})());let o={updated:0,version:DEFAULT_CONFIG.version};if(!t)try{o=await getConfig()}catch(n){if(t=!0,"Forbidden"===n.message){console.error("[SCHOLEXT] Access to configuration data is forbidden. This is likely due to an invalid JWT. We will try to generate a new one,"),localStorage.removeItem("userToken"),await remoteAuth();try{o=await getConfig(),t=!1}catch(r){console.error("[SCHOLEXT] Failed to fetch configuration data after re-authentication. Something is very wrong",r)}}else"Network error"===n.message?console.error("[SCHOLEXT] Could not reach the server. It is possible that the server is down. Will still attempt to load configuration data from local storage."):console.error("[SCHOLEXT] An unknown error occurred while fetching configuration data.")}if(DEFAULT_CONFIG.version!=o.version){console.log("Version Mismatch");return}if(t){if(null!==localStorage.getItem("extConfig"))try{extConfig=JSON.parse(localStorage.getItem("extConfig"))}catch{localStorage.removeItem("extConfig");return}else{console.error("[SCHOLEXT] No configuration data could be loaded. Server is likely down and no local configuration data exists. Please try again later.");return}if(console.warn("[SCHOLEXT] Loaded configuration data from local storage. We were unable to reach the server to fetch the latest configuration data so this may be out of date."),console.warn("[SCHOLEXT] It is possible that some functionality will not work as intended until the server is back online."),console.warn("[SCHOLEXT] If you are seeing this message frequently, please contact the SchoL Extension team."),!localStorage.getItem("skipServerLoading")){localStorage.setItem("skipServerLoading",Date.now()+18e5),document.body.insertAdjacentHTML("beforeend",'<div id="scholext-fail-toaster" class="toast alert" data-toast></div>');let l=$("#scholext-fail-toaster");l.toastActivate({text:"Could not connect to SchoL Extension server. Custom timetable colours may not work correctly",css:"alert"})}}else if(null!==localStorage.getItem("extConfig")){try{extConfig=JSON.parse(localStorage.getItem("extConfig"))}catch{localStorage.removeItem("extConfig");return}extConfig.updated<o.updated&&(extConfig=o,localStorage.setItem("extConfig",JSON.stringify(extConfig)))}else 0!==o.updated?(extConfig=o,localStorage.setItem("extConfig",JSON.stringify(extConfig))):(extConfig=DEFAULT_CONFIG,await timetableCache(!0));(!localStorage.getItem("lastThemeCache")||localStorage.getItem("lastThemeCache")&&Date.now()-parseInt(localStorage.getItem("lastThemeCache"))>864e5||extConfig.themedefault=={})&&await timetableCache(),allPages(),"/"==window.location.pathname&&mainPage(),"/learning/classes"==window.location.pathname&&classesPage(),window.location.pathname.startsWith("/calendar")&&setInterval(eDiary,500),window.location.pathname.startsWith("/learning/due")&&setInterval(dueWork,500),window.location.pathname.startsWith("/learning/grades")&&feedback(),window.location.pathname.startsWith("/learning/assessments/")&&assessments(),window.location.pathname.startsWith("/timetable")&&timetable(),window.location.pathname.startsWith("/search/user")&&profilePage(),window.location.pathname.startsWith("/search/user/")&&window.location.pathname.endsWith(schoolboxUser.id)&&await loadSettings(),window.location.pathname.startsWith("/settings/messages")&&await loadSettings()}async function timetableCache(t){return new Promise(async o=>{await remoteAuth(),fetch("/timetable").then(t=>t.text()).then(n=>{let r=Object.assign({},extConfig.theme)||{},l={},i=new DOMParser,a=i.parseFromString(n,"text/html");for(let s of a.querySelectorAll(".timetable-subject[style*='background-color'] div"))REGEXP.exec(s.innerText)&&(l[REGEXP.exec(s.innerText)[1]]={color:s.parentNode.style.backgroundColor,image:null,current:"color"});for(let c in l)void 0===r[c]&&(r[c]=l[c]);for(let d in r)void 0===l[d]&&delete r[d];localStorage.setItem("lastThemeCache",Date.now()),JSON.stringify(extConfig.theme)!=JSON.stringify(r)||JSON.stringify(extConfig.themedefault)!=JSON.stringify(l)||t?(extConfig.theme=r,extConfig.themedefault=l,extConfig.updated=Date.now(),localStorage.setItem("extConfig",JSON.stringify(extConfig)),postConfig().then(t=>o())):o()})})}function rgbToHex(t,o,n){return"#"+(16777216+(t<<16)+(o<<8)+n).toString(16).slice(1)}function hexToRgb(t){var o=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);if(o){var n=parseInt(o[1],16),r=parseInt(o[2],16),l=parseInt(o[3],16);return n+", "+r+", "+l}return null}function getRGB(t){return parseInt(t,16)||t}function getsRGB(t){return getRGB(t)/255<=.03928?getRGB(t)/255/12.92:Math.pow((getRGB(t)/255+.055)/1.055,2.4)}function getLuminance(t){return .2126*getsRGB(t.substr(1,2))+.7152*getsRGB(t.substr(3,2))+.0722*getsRGB(t.substr(-2))}function getContrast(t,o){let n=getLuminance(t),r=getLuminance(o);return(Math.max(n,r)+.25)/(Math.min(n,r)+.25)}function getTextColor(t){let o=getContrast(t,"#ffffff"),n=getContrast(t,"#000000");return o>n?"#ffffff":"#000000"}function rgbsFromHexes(t){let o=[...t.matchAll(/(?:[0-9a-fA-F]{6})/g)],n=[];for(let r of o){let l=hexToRgb(r);l&&n.push(`rgb(${l})`)}return n}async function allPages(){if(document.getElementById("message-list").children[1]){let t=document.createElement("input");t.placeholder="Type to search",t.addEventListener("keyup",()=>{if(document.activeElement===t){let o=t.value.toLowerCase(),n=document.getElementById("msg-content").querySelectorAll("li");for(let r of n)-1==r.textContent.toLocaleLowerCase().trim().indexOf(o)?r.style.display="none":r.style.display="block"}}),document.getElementById("message-list").children[1].appendChild(t)}for(let o of document.querySelectorAll("time"))if(o.textContent.includes("remaining")){let n=(new Date(o.dateTime).getTime()-Date.now())/864e5,r=(new Date(o.dateTime).getTime()-Date.now())/36e5,l=(new Date(o.dateTime).getTime()-Date.now())/6e4;n>=1?o.textContent=Math.round(n)+(1==n?" day left":" days left"):r>=1?o.textContent=Math.round(r)+(1==r?" hour left":" hours left"):o.textContent=Math.round(l)+(1==l?" minute left":" minutes left")}document.querySelector("#profile-options .icon-staff-students").insertAdjacentHTML("afterend",'<li><a href="/timetable" class="icon-timetable">Timetable</a></li>'),extConfig.darkmodeMode||(extConfig.darkmodeMode=DEFAULT_CONFIG.darkmodetheme,extConfig.updated=Date.now(),localStorage.setItem("extConfig",JSON.stringify(extConfig)),await postConfig()),!0==themeApplied&&loadTheme(extConfig.darkmodeTheme,extConfig.darkmodeMode),colourSidebar(),colourTimetable(),colourDuework(),setTimeout(colourDuework,1e3)}function colourSidebar(){for(let t of document.querySelectorAll("#side-menu-mysubjects li a")){let o=extConfig.theme[t.href.split("/")[t.href.split("/").length-1]];o?.color&&(t.style.backgroundColor=o.color.replace("rgb","rgba").replace(")",", 10%)"),t.style.borderLeft="7px solid "+o.color)}}function colourDuework(){if(extConfig.settings.colourduework){let t=document.querySelectorAll(".Schoolbox_Learning_Component_Dashboard_UpcomingWorkController li");for(let o of(t.length||(t=document.querySelectorAll("#report_content li")),t)){let n=REGEXP.exec(o.querySelector("a:not(.title)").innerText)[1]?.split(",");for(let r of n){let l=extConfig.theme[r]?.color;l&&(o.style.backgroundColor=l.replace("rgb","rgba").replace(")",", 10%)"),o.style.borderLeft="10px solid "+l)}}}}function colourTimetable(){for(let t of document.querySelectorAll(".timetable-subject[style*='background-color'] div, .timetable-subject[style*='background'] div, .show-for-small-only tr td .timetable-subject div")){if(!REGEXP.exec(t.textContent))continue;let o=REGEXP.exec(t.innerText)[1].split(",");for(let n of o){let r=extConfig.theme[n];if(!r?.color)continue;let l=getTextColor(rgbToHex(...r.color.replace(/[^\d\s]/g,"").split(" ").map(Number)).toUpperCase());t.parentNode.style.backgroundColor=r.color,t.parentNode.style.color=l,t.parentNode.querySelectorAll("*:not(a)").forEach(t=>{t.style.color=l}),"#000000"!=l&&t.parentNode.querySelectorAll("a").forEach(t=>t.style.color="#b0e1ff"),"image"==r.current&&r.image&&(t.parentNode.style.backgroundImage="url("+r.image+")",t.parentNode.style.backgroundSize="100% 100%")}}}function classesPage(){let t=document.querySelectorAll("div.v-card");for(let o of t)for(let n of o.querySelector("p.meta").innerText.split("\n")[0].split(",")){let r=extConfig.theme[n]?.color;r&&(o.querySelector("div.card-class-image").style.borderBottom=`10px solid ${r}`)}}function profilePage(){fetch(THEME_API+"/pronouns/"+window.location.pathname.split("/")[window.location.pathname.split("/").length-1],{headers:new Headers({Authorization:"Basic "+localStorage.getItem("userToken")})}).then(t=>t.json()).then(t=>{let o=t.join(", "),n=document.querySelector(".main .profile.content .row");n.style.position="relative",n.insertAdjacentHTML("beforeend",`<span class="neutral label hide-for-small-down" style="position: absolute; top: 0; right: 0; margin: 0${o.length?"":"; display: none !important"}" id="pronounslabel">Pronouns: ${o}</span>`),n.children[1].insertAdjacentHTML("beforeend",`<dl class="hide-for-medium-up" ${o.length?"":"style='display: none !important'"}><dt class="small-4 medium-3 columns">Pronouns:</dt><dd class="small-8 medium-9 columns" id="pronounsrow">${o}</dd></dl>`)})}async function loadSettings(){let t="";for(let o in extConfig.theme){let n=extConfig.theme[o].color,r=rgbToHex(...n.replace(/[^\d\s]/g,"").split(" ").map(Number));t+=`<tr role="row" class="subject-color-row" style="background-color: ${n.replace("rgb","rgba").replace(")",", 10%)")}; ${"image"===extConfig.theme[o].current?"background-image: url("+extConfig.theme[o].image+");":""} background-size: 100% 100%; border-left: 7px solid ${n}">
            <td>${o}</td>
            <td>
                <div id="image-uploader">
                    <input type="color" style="display: ${"image"===extConfig.theme[o].current?"none":""}" value="${r}">
                    <input type="url" class="image-drop-zone"pattern="https://.*" required placeholder="Drag Image Here" style="display: ${"image"===extConfig.theme[o].current?"":"none"}" value="${null===extConfig.theme[o].image?"":extConfig.theme[o].image}">
                    <p style="display: none; color: red" class="invalidurl">Not a valid URL</p>
                </div>
            </td>
            <td style="text-align: center">
                <a id="settingsresset" data-target="delete" data-state="closed" class="icon-refresh" title="Reset" style="vertical-align: middle; line-height: 40px"></a>
            </td>
            <td style="text-align: center">
                <a data-target="delete" style="vertical-align: middle; line-height: 39px; display: ${"image"===extConfig.theme[o].current?"none":""}" data-state="closed" class="icon-image" title="Image">
                <a data-target="delete" style="vertical-align: middle; line-height: 39px; display: ${"image"===extConfig.theme[o].current?"":"none"}" data-state="closed" class="icon-drag-drop" title="Colour">
            </td>
        </tr>`}function l(t){let o='<option disabled="" selected="">Click to select an option</option>';return t.forEach(t=>{o+=`<option value="${t.value}">${t.label}</option>`}),o}Object.keys(extConfig.theme).length<1&&(t+=`<tr role="row" class="subject-color-row">
            <td colspan="3">There are no timetable subjects associated with your account</td>
        </tr>`);let i=l([{value:"defaults",label:"System Defaults"},{value:"light",label:"Light"},{value:"dark",label:"Dark"},]),a=l([{value:"original",label:"Original"},{value:"artdeco",label:"Art Deco"},{value:"evergreen",label:"Evergreen"},{value:"haunt",label:"Haunt"},{value:"blurple",label:"Blurple"},{value:"blossom",label:"Blossom"},{value:"alpine",label:"Alpine"},]),s="",c=await getThemes();if(c)for(let d of(s+="<option disabled selected>Click to select a theme</option>",c))s+=`<option ${localStorage.getItem("currentTheme")===d.name?"selected":""} value='${d.theme}'>${d.name}</option>`;let u={colourduework:["Coloured Due Work","Add colours to due work items based on the timetable"],compacttimetable:["Compact Timetable","Remove empty items/rows from the timetable on the dashboard and timetable page"]},g="";for(let m in u)g+=`<tr>
            <td style="border-bottom: 0px !important"><label for="toggle_${m}">${u[m][0]}<p>${u[m][1]}</p></label></td>
            <td style="border-bottom: 0px !important">
                <div class="long switch no-margin" style="float: right">
                    <input id="toggle_${m}" type="checkbox" name="toggle_${m}" value="1" checked>
                    <label for="toggle_${m}">
                        <span>Enabled</span>
                        <span>Disabled</span>
                    </label>
                </div>
            </td>
        </tr>`;let p=window.location.pathname.startsWith("/search/user"),h;function f(t){var o=document.getElementById("customStuff");o.innerHTML+=t}for(let y in p?((h=(h=document.querySelectorAll("#content .row"))[3]?h[3]:h[1]).querySelector("div").classList="medium-12 large-6 island",h.querySelector("div").insertAdjacentHTML("afterbegin",'<h2 class="subheader">Profile</h2>')):((h=document.querySelector("#msg-settings")).insertAdjacentHTML("beforebegin",'<div class="row"><div class="medium-12 large-6 island" id="msg-settings-wrapper"></div></div>'),document.getElementById("msg-settings-wrapper").appendChild(h),h=h.parentNode),h.insertAdjacentHTML(p?"beforeend":"afterend","<div class='medium-12 large-6 island'><div id=customStuff></div></div>"),module_Pronouns=`            <h2 class="subheader">Preferred Pronouns</h2>
    <section>
        <fieldset class="content">
            <legend><strong>Preferred Pronouns</strong></legend>
            <div class="small-12 columns">
                <p>St Michael's is committed to ensuring that we have safe and inclusive learning environments and in keeping with our values, that we respect and acknowledge the diversity of our community. We have therefore provided the option for students and staff to choose their pronouns on SchoL - noting that this is not currrently reflected on School records nor an official notification to the School. There is no expectation or requirement for students or staff to select their pronouns.</p>
            </div>
            <div class="small-12 medium-6 columns">
                <fieldset class="content">
                    <label>Select Pronouns
                        <div class="checklist checklist-container" id="pronoun-list">
                            <input id="checkbox-pronoun1" type="checkbox" name="theythem"><label for="checkbox-pronoun1">They/Them</label>
                            <input id="checkbox-pronoun2" type="checkbox" name="hehim"><label for="checkbox-pronoun2">He/Him</label>
                            <input id="checkbox-pronoun3" type="checkbox" name="sheher"><label for="checkbox-pronoun3">She/Her</label>
                            <input id="checkbox-pronoun4" type="checkbox" name="other"><label for="checkbox-pronoun4">Other (Ask Me)</label>
                        </div>
                    </label>
                </fieldset>
            </div>
            <div class="small-12 medium-6 columns">
                <fieldset class="content">
                    <label>Select roles to show your pronouns to
                        <div class="checklist checklist-container" id="pronoun-roles">
                            <input id="checkbox-roles1" type="checkbox" name="0"><label for="checkbox-roles1">Students</label>
                            <input id="checkbox-roles2" type="checkbox" name="1"><label for="checkbox-roles2">Staff/Teachers</label>
                            <input id="checkbox-roles3" type="checkbox" name="2"><label for="checkbox-roles3">Parents</label>
                        </div>
                    </label>
                </fieldset>
            </div>
            <div class="small-12 columns">
                <p class="meta"><strong>Note: </strong>To make official changes of names to a student's records, there is a process that parents need to follow by contacting the Head of the School.</p>
            </div>
        </fieldset>
    </section>`,module_Timetable=`
            <h2 class="subheader">Timetable Themes</h2>
            <section>
                <fieldset class="content">
                    <legend><strong>Timetable Theme Import/Export</strong></legend>
                    <div class="small-12 columns">
                        <p>Import a timetable theme (list of hex codes seperated by dashes), this also supports URLs from <a target="_blank" href="https://coolors.co/d9ed92-b5e48c-99d98c-76c893-52b69a-34a0a4-168aad-1a759f-1e6091-184e77">coolors.co</a></p>
                    </div>
                    <div class="small-12 columns">
                        <div class="input-group">
                            <input type="text" id="importtext" placeholder="Hex codes seperated by dashes (#FDFD96-#22AA66...) or https://coolors.co/ link">
                            <a class="button disabled" id="importbtn">Import</a>
                        </div>
                    </div>
                    <div class="small-12 columns"><p>Export your current timetable theme to share it with friends!</p></div>
                    <div class="small-12 columns"><div class="input-group"><input type="text" id="currenttheme" readonly><a class="button" id="exportbtn">Export</a></div></div>
                    <div class="small-12 columns"><p>Or choose a premade timetable theme!</p></div>
                    <div class="small-12 columns"><select id="context-selector-themes">${s}</select></div>
                </fieldset>
                <fieldset class="content">
                    <legend><strong>Settings</strong></legend>
                    <div class="small-12 columns">
                        <table class="no-margin"><tbody>${g}</tbody></table>
                    </div>
                </fieldset>
                <div class="component-action">
                    <section>
                        <a class="button" style="color: #ff5555;" id="resetbtn">Reset</a>
                    </section>
                </div>
            </section>
            <table class="dataTable no-footer" role="grid">
            <thead>
                <tr role="row">
                    <th style="width: 1000px">Subject</th>
                    <th style="width: 200px">Pick Theme</th>
                    <th></th>
                    <th></th>
                </tr>
            </thead>
            <tbody>${t}</tbody>
        </table>`,module_Themes=`  
        <h2 class="subheader">Custom Themes</h2>
        <section>
            <fieldset class="content">
                <legend><strong>Colour Theme Selector</strong></legend>
                <div class="small-12 columns">
                    <p>Select your Colour Theme Here!<br></p>
                </div>
                <div class="small-12 columns" style="margin-top:10px;"><select id="context-selector-colour-themes">${a}</select></div>

                <legend><strong>Dark Mode</strong></legend>
                <div class="small-12 columns">
                <p>And select the mode here!<br></p>
                </div>
                <div class="small-12 columns" style="margin-top:10px;"><select id="context-selector-dark">${i}</select>
                <p class="meta">'System Defaults' uses your system theme setting, while light and dark mode override that setting for your preference.</p></div>
            </fieldset>
            
            <fieldset class="content">
            <div class="small-12 columns">
                <p class="meta"><strong>Note:</strong> Not all text on SchoL will be compatible with custom themes, due to overridden custom formatting added to news/blog posts.</p>
            </div>
            </fieldset>
        </section>
        `,module_Credits=`
    <div class="component-action" style="margin-top: 20px; margin-bottom: 20px;">
        <span style="font-size: 12px; color: #AAA;">
            Additional features developed by Yuma (M2024), Sebastien (H2023), Max (S2024), and Zac (H2022).
        </span>
    </div>

    <ul class="meta" style="font-size: 12px">
        SchoL features and profile settings are managed by the School Leadership Team and the St Michael's ICT Steering Committee. Feedback and future suggestions for the improvement of SchoL can be directed to: <a href="mailto:scholfeedback@stmichaels.vic.edu.au">scholfeedback@stmichaels.vic.edu.au</a>. <!-- rip dead name remover :( -->
    </ul>`,f(module_Pronouns),f(module_Themes),f(module_Timetable),f(module_Credits),document.querySelector("#context-selector-dark").value=extConfig.darkmodeMode,document.querySelector("#context-selector-dark").addEventListener("change",async function(){extConfig.darkmodeMode=this.value,extConfig.updated=Date.now(),localStorage.setItem("extConfig",JSON.stringify(extConfig)),await postConfig(),window.location.reload()}),document.querySelector("#context-selector-colour-themes").value=extConfig.darkmodeTheme,document.querySelector("#context-selector-colour-themes").addEventListener("change",async function(){extConfig.darkmodeTheme=this.value,extConfig.updated=Date.now(),localStorage.setItem("extConfig",JSON.stringify(extConfig)),await postConfig(),window.location.reload()}),u){let b=document.getElementById("toggle_"+y);extConfig.settings[y]?b.setAttribute("checked",1):b.removeAttribute("checked",1),b.addEventListener("change",async function(){extConfig.settings[y]=b.checked,extConfig.updated=Date.now(),localStorage.setItem("extConfig",JSON.stringify(extConfig)),await postConfig()})}document.getElementById("image-uploader");let x=document.getElementById("resetbtn"),v=document.getElementById("currenttheme"),C=document.getElementById("importtext"),w=document.getElementById("importbtn"),S=document.getElementById("exportbtn"),_=document.getElementById("context-selector-themes");for(let k of(document.addEventListener("drop",async function(t){if(t.target.classList.contains("image-drop-zone")&&(t.preventDefault(),t.dataTransfer&&t.dataTransfer.files)){var o=t.dataTransfer.files[0].type;if(IMAGE_TYPES.includes(o)){if(!localStorage.getItem("hasUploaded")&&!window.confirm("This image will be stored privately on school servers under your account. Continue?")){t.target.parentElement.style.border="5px solid red";return}t.target.parentElement.style.border="5px solid green";let n=new FormData;n.append("upload",t.dataTransfer.files[0]);let r="https://learning.stmichaels.vic.edu.au"+(await postImage(n)).meta.file._links.image,l=t.target.parentElement.parentElement.parentElement,i=l.querySelector("td").innerText;extConfig.theme[i].image=r,l.style.backgroundImage="url("+r+")",l.style.backgroundSize="100% 100%",localStorage.setItem("extConfig",JSON.stringify(extConfig)),await postConfig(),localStorage.setItem("hasUploaded",1)}else t.target.parentElement.style.border="5px solid red"}},!0),document.querySelectorAll("#pronoun-list input")))extConfig.pronouns.selected.includes(k.name)&&(k.checked=!0),k.addEventListener("change",async function(){k.checked?extConfig.pronouns.selected.includes(k.name)||extConfig.pronouns.selected.push(k.name):extConfig.pronouns.selected=extConfig.pronouns.selected.filter(t=>t!=k.name),document.getElementById("pronounslabel").innerText="Pronouns: "+extConfig.pronouns.selected.map(t=>VALID_PRONOUNS[t]).join(", "),document.getElementById("pronounsrow").innerText=extConfig.pronouns.selected.map(t=>VALID_PRONOUNS[t]).join(", "),extConfig.pronouns.selected.length?(document.getElementById("pronounslabel").style.display="",document.getElementById("pronounsrow").parentNode.style.display=""):(document.getElementById("pronounslabel").style.setProperty("display","none","important"),document.getElementById("pronounsrow").parentNode.style.setProperty("display","none","important")),extConfig.updated=Date.now(),localStorage.setItem("extConfig",JSON.stringify(extConfig)),await postConfig()});for(let T of document.querySelectorAll("#pronoun-roles input"))extConfig.pronouns.show[parseInt(T.name)]&&(T.checked=!0),T.addEventListener("change",async function(){extConfig.pronouns.show[parseInt(T.name)]=T.checked,extConfig.updated=Date.now(),localStorage.setItem("extConfig",JSON.stringify(extConfig)),await postConfig()});function E(){v.value=Object.values(extConfig.theme).map(t=>{if("color"===t.current)return t.color}).filter(t=>void 0!==t).map(t=>rgbToHex(...t.replace(/[^\d\s]/g,"").split(" ").map(Number))).join("-").replaceAll("#","").toUpperCase()}for(let I of(E(),document.querySelectorAll(".subject-color-row"))){let A=I.children[0].innerText;I.children[1]&&(I.children[1].children[0].children[0].addEventListener("change",async function(t){let o="rgb("+hexToRgb(t.target.value)+")";I.style.borderLeft="7px solid "+o,I.style.backgroundColor=o.replace("rgb","rgba").replace(")",", 10%)"),extConfig.theme[A].color=o,extConfig.theme[A].current="color",extConfig.updated=Date.now(),localStorage.setItem("extConfig",JSON.stringify(extConfig)),colourSidebar(),E(),await postConfig()}),I.children[1].children[0].children[1].addEventListener("change",async function(t){let o=t.target.value,n=null!==o.match(/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/g)&&t.target.reportValidity();t.target.style.border=n?"solid green 2px":"solid red 1px",I.querySelector(".invalidurl").style.display=n?"none":"",extConfig.theme[A].image=n?o:null,extConfig.theme[A].current=n?"image":"color",I.style.backgroundImage=n?"url("+o+")":"",I.style.backgroundSize="100% 100%",extConfig.updated=Date.now(),localStorage.setItem("extConfig",JSON.stringify(extConfig)),await postConfig(),setTimeout(function(){t.target.style.border=""},5e3)}),I.children[2].children[0].addEventListener("click",async function(){let t=extConfig.themedefault[A].color;I.style.borderLeft="7px solid "+t,I.style.backgroundColor=t.replace("rgb","rgba").replace(")",", 10%)"),I.style.backgroundImage="",I.style.backgroundSize="100% 100%",I.children[1].children[0].children[0].value=rgbToHex(...t.replace(/[^\d\s]/g,"").split(" ").map(Number)),I.children[1].children[0].children[1].value="",extConfig.theme[A]={color:t,image:null,current:"color"},extConfig.updated=Date.now(),localStorage.setItem("extConfig",JSON.stringify(extConfig)),colourSidebar(),E(),await postConfig()}),I.children[3].children[0].addEventListener("click",async function(){extConfig.theme[A].current="image",extConfig.updated=Date.now(),localStorage.setItem("extConfig",JSON.stringify(extConfig)),I.children[1].children[0].children[0].style.display="none",I.children[1].children[0].children[1].style.display="",I.style.backgroundImage="url("+extConfig.theme[A].image+")",I.style.backgroundSize="100% 100%",I.children[3].children[0].style.display="none",I.children[3].children[1].style.display="",await postConfig()}),I.children[3].children[1].addEventListener("click",async function(){extConfig.theme[A].current="color",extConfig.updated=Date.now(),localStorage.setItem("extConfig",JSON.stringify(extConfig)),I.children[1].children[0].children[0].style.display="",I.children[1].children[0].children[1].style.display="none",I.style.backgroundColor=extConfig.theme[A].color.replace("rgb","rgba").replace(")",", 10%)"),I.style.backgroundImage="",I.children[3].children[0].style.display="",I.children[3].children[1].style.display="none",I.querySelector(".invalidurl").style.display="none",await postConfig()}))}_.addEventListener("change",async function(t){let o=t.target.value.split("-"),n=Object.assign({},extConfig.themedefault);console.log(t.target),localStorage.setItem("currentTheme",_.options[_.selectedIndex].text);let r=0;for(subjectcode in n)n[subjectcode]={color:"rgb("+hexToRgb(o[r])+")",image:null,current:"color"},++r>=o.length&&(r=0);extConfig.theme=n,extConfig.updated=Date.now(),localStorage.setItem("extConfig",JSON.stringify(extConfig)),await postConfig(),window.location.reload()}),S.addEventListener("click",function(){S.innerText="Copied!",navigator.userAgent.match(/ipad|iphone/i)?Clipboard.copy(v.value):(v.select(),document.execCommand("copy")),setTimeout(()=>{S.innerText="Export"},1e3)}),w.addEventListener("click",async function(){if(!C.value)return;let t=extConfig.themedefault,o=rgbsFromHexes(C.value);if(0==o.length){w.parentElement.insertAdjacentHTML("afterend",'<div data-alert class="alert-box alert themecodealert"><strong>Invalid Input:</strong> Ensure the text you enter is a list of hex codes seperated by dashes or a coolors.co link.<br><br>For example: "d9ed92-b5e48c-99d98c-76c893-52b69a-34a0a4"</div>'),setTimeout(function(){document.querySelector(".themecodealert")?.remove()},6e3);return}let n=0;for(subjectcode in t)t[subjectcode]={color:o[n],image:null,current:"color"},++n>=o.length&&(n=0);extConfig.theme=t,extConfig.updated=Date.now(),localStorage.setItem("extConfig",JSON.stringify(extConfig)),await postConfig(),window.location.reload()}),x.addEventListener("click",async function(){confirm("Reset: This will reset all your theme colours and settings back to default, are you sure you want to do this?")&&(extConfig=DEFAULT_CONFIG,await timetableCache(!0),window.location.reload())}),C.addEventListener("keyup",function(){C.value?w.classList="button":w.classList="button disabled"})}function dueWork(){if(document.querySelector(".event-container span.fc-event-title"),null===document.querySelector("span[recoloured]"))for(let t of(colourDuework(),document.querySelectorAll(".event-container span.fc-event-title"))){t.setAttribute("recoloured",1);let o=REGEXP.exec(t.innerText)[1]?.split(",");if(o)for(let n of o){let r=extConfig.theme[n]?.color;if(!r)continue;let l=getTextColor(rgbToHex(...r.replace(/[^\d\s]/g,"").split(" ").map(Number)).toUpperCase());for(let i of(t.parentNode.style.backgroundColor=r,t.parentNode.children))i.style.color=l}}}function colourEDiaryList(){if(!document.querySelector("div[id='calender']")||"There are no upcoming calendar events"!==document.querySelector("div[id='calender']").querySelector("div.empty-state > p").textContent){if(0===document.querySelectorAll(".fc-list-event").length){setTimeout(colourEDiaryList,500);return}document.querySelectorAll(".fc-list-event").forEach(t=>{let o=t.querySelector(".fc-list-event-dot");o.style.backgroundColor=o.style.borderColor;let n=REGEXP.exec(t.querySelector(".fc-event-title").innerText);if(!n)return;let r=extConfig.theme[n[1]]?.color;r&&(o.style.borderColor=r,o.style.backgroundColor=r)})}}function feedback(){for(let t of document.querySelectorAll(".activity-list"))t.querySelector(".no-margin")&&t.querySelector(".flex-grade")&&SHOW_FEEDBACKS.some(o=>t.querySelector(".no-margin").innerText.includes(o))&&(t.querySelector(".flex-grade").innerHTML+='<div class="grade gradient-10-bg no-margin"><span>Click to view feedback</span></div>');let o=parseInt(document.querySelector(".card a p.meta")?.innerText.replace(/\D/g,""));if(!isNaN(o)){let n=new Date().getFullYear(),r=n,l=n-(o-12+5);for(summary of((o<=6||o>12)&&(r+=1,l=r),12==o&&(r-=1),l<2021&&(l=2021),document.querySelectorAll("select#context-selector-semester option[value]")))summary.innerText.includes("Summary")&&!(parseInt(summary.value)>=l&&parseInt(summary.value)<=r)&&(summary.style.display="none")}for(let i of document.querySelectorAll("ul.activity-list")){let a=i.querySelector(".subject-group span.meta")?.innerText.replace("), (",",");if(a&&REGEXP.exec(a)[1]){let s=REGEXP.exec(a)[1]?.split(",");for(let c of s){let d=extConfig.theme[c]?.color;d&&(i.style.borderLeft="7px solid "+d,i.style.backgroundColor=d.replace("rgb","rgba").replace(")",", 10%)"),i.children[0].style.backgroundColor=d.replace("rgb","rgba").replace(")",", 10%)"),i.children[1].style.backgroundColor=d.replace("rgb","rgba").replace(")",", 10%)"))}}}}function assessments(){let t=document.querySelectorAll(".subheader");for(e of t){if(!["SUBMIT RESPONSE","SUBMISSION HISTORY"].includes(e.innerText))continue;let o=document.querySelector(".breadcrumb")?.innerText.match(REGEXP),n=document.querySelector(".breadcrumb")?.innerText.match(REGEXP2),r=o?o[0]:n[0];if(7<=parseInt(r.slice(1,3))&&11>=parseInt(r.slice(1,3))){let l=document.querySelectorAll(".row");l[l.length-1].insertAdjacentHTML("beforeend",`<div class="small-12 island">
                <section style="text-align: center; padding-bottom: 10px">
                    <img src="/storage/image.php?hash=82df5e189a863cb13e2e988daa1c7098ef4aa9e1">
                </section>
            </div>`)}break}}function eDiary(){let t=document.querySelector(".fc-button-group .fc-button-active").innerText;if("List"==t?colourEDiaryList():document.querySelectorAll(".fc-timegrid-event, .fc-daygrid-event").forEach(t=>{let o=REGEXP.exec(t.innerText);if(!o)return;let n=extConfig.theme[o[1]]?.color;if(!n)return;let r=getTextColor(rgbToHex(...n.replace(/[^\d\s]/g,"").split(" ").map(Number)).toUpperCase());t.style.backgroundColor=n,t.querySelectorAll("*").forEach(t=>{t.style.color=r})}),"Month"==t)for(let o of document.querySelectorAll("div.fc-popover-body .fc-daygrid-event:not([recoloured])")){let n=REGEXP.exec(o.innerText);if(!n)continue;let r=extConfig.theme[n[1]]?.color;if(!r)continue;let l=getTextColor(rgbToHex(...r.replace(/[^\d\s]/g,"").split(" ").map(Number)).toUpperCase());o.style.backgroundColor=r,o.querySelectorAll("*").forEach(t=>{t.style.color=l}),o.setAttribute("recoloured",1)}}async function mainPage(){if(document.querySelector("h2[data-timetable-header]")||fetch("https://services.stmichaels.vic.edu.au/dwi.cfm?otype=json").then(t=>t.json()).then(t=>document.querySelector(".island").insertAdjacentHTML("afterbegin",`<h2 class="subheader">${t.text}</h2>`)),extConfig.settings.compacttimetable){let t=document.querySelectorAll(".timetable th, .show-for-small-only th"),o=document.querySelectorAll(".timetable td, .show-for-small-only td");for(let n=0;n<t.length;n++)TIMETABLE_WHITELIST.includes(t[n].childNodes[0].textContent.trim())||o[n].textContent.trim()||(t[n].remove(),o[n].remove())}(document.querySelector(".awardsComponent")||document.querySelector("#component62394"))?.insertAdjacentHTML("afterend",`
    <style>
        .PTVIcon .line-pill .route-lock-up {
            display: inline-block;
            padding-right: 5px;
            padding-left: 2px;
            height: 28px;
            border: 2px solid;
            border-radius: 100px;
            display: -webkit-inline-box; display: -webkit-inline-flex; display: -ms-inline-flexbox; display: inline-flex;
            -webkit-box-align: center; -webkit-align-items: center; -ms-flex-align: center; align-items: center;
            box-sizing: border-box;
        }
        .PTVIcon .line-pill .route-lock-up span {
            -webkit-box-flex: 1; -webkit-flex: 1 0 auto; -ms-flex: 1 0 auto; flex: 1 0 auto;
            padding-right: 3px;
            display: -webkit-box; display: -webkit-flex; display: -ms-flexbox; display: flex;
            -webkit-box-align: center; -webkit-align-items: center; -ms-flex-align: center; align-items: center;
            height: 100%;
        }
        .PTVIcon .line-pill .route-lock-up .icon {
            width: 21px;
            height: 21px;
        }
        .PTVIcon .direction-title {
            font-weight: 700;
            font-size: 13px;
            padding-left: 3px;
            margin: 0;
        }
        .PTVIcon.time .line-pill .route-lock-up {
            border: 0;
            padding: 0 9px 0 5px;
            border-radius: 100px;
            -webkit-box-align: center; -webkit-align-items: center; -ms-flex-align: center; align-items: center;
            font-weight: 600;
            -webkit-box-sizing: content-box; box-sizing: content-box;
            text-align: left;
        }

        .PTVIcon.tram .route-lock-up {
            border-color: #78be20 !important;
        }
        .PTVIcon.tram .icon {
            background-image: url("https://www.ptv.vic.gov.au/resources/themes/ptv-mpw/public/images/icons/tram.png");
            background-image: url("https://www.ptv.vic.gov.au/resources/themes/ptv-mpw/public/images/icons/tram.svg");
        }

        .PTVIcon.train .route-lock-up {
            border-color: #0072ce !important;
        }
        .PTVIcon.train .icon {
            background-image: url("https://www.ptv.vic.gov.au/resources/themes/ptv-mpw/public/images/icons/train.png");
            background-image: url("https://www.ptv.vic.gov.au/resources/themes/ptv-mpw/public/images/icons/train.svg");
        }
    </style>
    <div class="component-container">
        <div class="row">
            <div class="small-12 island">
                <h2 class="subheader">Public Transport Nearby</h2>
                <section id="ptvDepartures"></section>
            </div>
        </div>
    </div>`);let r,l;async function i(){if(!1===PTVDepatureUpdate)return;let t="";r=!0;let o=await (await fetch(`${THEME_API}/ptv/schedule`)).json();for(let n of(l=o.expires,o.schedule.sort((t,o)=>t.route==o.route?0:t.route<o.route?1:-1))){let i=new Date(n.departures[0]?.scheduled_time),a=Math.ceil((n.departures[0]?.scheduled_time-new Date().getTime())/1e3);t+=`
                <li style="border-left: 15px solid ${n.colour};">
                    <div class="card small-12" data-equalizer style="position: relative; padding-bottom: 8px;">
                        <div>
                            <div style="display: inline; float: left" class="PTVIcon ${0==n.type?"train":"tram"}">
                                <span class="line-pill">
                                    <div class="route-lock-up">
                                        <i class="icon"></i>
                                        <p class="direction-title">${n.route}</p>
                                    </div>
                                </span>
                            </div>
                            <div style="display: inline"><h3 style="padding-left: 10px"><a class="title">${n.prefix}to ${n.name}</a></h3></div>
                        </div>
                        ${0==n.departures.length?'<p style="margin-top: 10px">No more scheduled departures today</p>':`
                            <p style="margin-top: 10px">
                                Scheduled <strong>${i.toLocaleString("en-AU",{hour:"numeric",minute:"2-digit"})}</strong>${n.departures.length>1?", ":""}
                                ${n.departures.slice(1,4).map(t=>new Date(t.scheduled_time).toLocaleString("en-AU",{hour:"numeric",minute:"2-digit"})).join(", ")}
                                <span class="meta" style="margin-left: 10px">${null!==n.departures[0].platform?"Platform "+n.departures[0].platform:"&nbsp"}
                            </p>
                            <div style="position: absolute; top: 50%; right: 15px; transform: translate(0, -50%);" class="PTVIcon time">
                                <span class="line-pill">
                                    <div class="route-lock-up" style="background: rgba(${a<20?"0, 206, 37, 0.25":"0, 114, 206, "+(.35-(a/900>1?1:a/900)*.3)});">
                                        <p class="direction-title" time="${i}">${a<20?"Now":a<3600?`${Math.ceil(a/60)} ${1==Math.ceil(a/60)?"min":"mins"}`:`${Math.ceil(a/3600)} ${1==Math.ceil(a/3600)?"hour":"hours"}`}</p>
                                    </div>
                                </span>
                            </div>
                        `}
                    </div>
                </li>
            `}let s=document.getElementById("ptvDepartures");s&&(s.innerHTML=`<ul class="information-list">${t}</ul>`),r=!1}window.addEventListener("focus",function(t){PTVDepatureUpdate=!0},!1),window.addEventListener("blur",function(t){PTVDepatureUpdate=!1},!1),i(),setInterval(i,6e4),setInterval(function t(){if(!r){if(l<new Date().getTime())return i();for(let o of document.querySelectorAll(".direction-title[time]")){if((seconds_diff=Math.ceil((new Date(o.getAttribute("time"))-new Date().getTime())/1e3))<0)return i();o.innerText=`${seconds_diff<20?"Now":seconds_diff<3600?`${Math.ceil(seconds_diff/60)} ${1==Math.ceil(seconds_diff/60)?"min":"mins"}`:`${Math.ceil(seconds_diff/3600)} ${1==Math.ceil(seconds_diff/3600)?"hour":"hours"}`}`,o.parentNode.style.background=`rgba(${seconds_diff<20?"0, 206, 37, 0.25":"0, 114, 206, "+(.35-(seconds_diff/900>1?1:seconds_diff/900)*.3)})`}}},1e3),document.querySelectorAll(".show-for-small-only").forEach(t=>{t.style.backgroundColor="#FFF"}),colourEDiaryList()}function timetable(){if(document.querySelector("h1[data-timetable-title]").style.display="inline-block",document.querySelector("h1[data-timetable-title]").insertAdjacentHTML("afterend",`
        <a href="/settings/messages" class="button show-for-landscape" style="margin-top: 10px; float: right; display: inline-block">Customise Colours</a>
        <a href="/settings/messages" class="button show-for-portrait" style="margin-top: 10px; display: inline-block">Customise Colours</a>
    `),extConfig.settings.compacttimetable){let t=document.querySelectorAll(".timetable tbody tr");for(let o of t)if(!TIMETABLE_WHITELIST.includes(o.querySelector("th").childNodes[0].textContent.trim())){for(let n of(hassubject=!1,o.querySelectorAll("td")))if("\n"!==n.innerText&&n.children[0].children.length>0){hassubject=!0;break}hassubject||(o.style.display="none")}let r=document.querySelectorAll(".show-for-small-only th"),l=document.querySelectorAll(".show-for-small-only td");for(let i=0;i<r.length;i++)TIMETABLE_WHITELIST.includes(r[i].childNodes[0].textContent.trim())||l[i].textContent.trim()||(r[i].remove(),l[i].remove())}}async function remoteAuth(){return new Promise(async(t,o)=>{try{let n=await fetch(REMOTE_API);if(n.ok){let r=await n.json();localStorage.setItem("userToken",r.token),t()}else throw Error(`Server error (${n.status})`)}catch(l){o(Error("Network error"))}})}function postImage(t){return new Promise(o=>{fetch("https://learning.stmichaels.vic.edu.au/storage/asyncUpload.php",{method:"POST",body:t}).then(async t=>{o(await t.json())})})}async function getThemes(){return new Promise(t=>{fetch(THEME_API+"/themes").then(t=>t.json()).then(o=>{t(o)})})}async function getConfig(){return new Promise(async(t,o)=>{try{localStorage.getItem("userToken")||await remoteAuth();let n=await fetch(THEME_API+"/config",{headers:new Headers({Authorization:"Basic "+localStorage.getItem("userToken")})});if(n.ok){let r=await n.json();t(r)}else o(403===n.status?Error("Forbidden"):Error(`Server error (${n.status})`))}catch(l){o(Error("Network error"))}})}async function postConfig(){return new Promise(async t=>{localStorage.getItem("userToken")||await remoteAuth(),fetch(THEME_API+"/config",{method:"POST",headers:new Headers({Authorization:"Basic "+localStorage.getItem("userToken"),"Content-Type":"application/json"}),body:JSON.stringify({config:extConfig,sbu:schoolboxUser})}).then(o=>{t()})})}function iSolvedForX(t,o){return Math.sqrt(t+36)+Math.sqrt(2*t-33)===Math.sqrt(6*t+6)&&o===Math.sqrt(6*t+6)?"Nice.":"The maths is not mathing"}if("complete"===document.readyState||"interactive"===document.readyState?load():window.addEventListener("DOMContentLoaded",()=>{load()}),window.Clipboard=function(t,o,n){var r,l,i,a;return{copy:l=function(l){(r=o.createElement("textArea")).value=l,o.body.appendChild(r),n.userAgent.match(/ipad|iphone/i)?((i=o.createRange()).selectNodeContents(r),(a=t.getSelection()).removeAllRanges(),a.addRange(i),r.setSelectionRange(0,999999)):r.select(),o.execCommand("copy"),o.body.removeChild(r)}}}(window,document,navigator),!(void 0!=localStorage.getItem("disableQOL")&&"undefined"==typeof forceEnableQOL)){let n=["Ducks are pretty cool","Custom themes one day???","Cubifying dogs, 50% loaded","Good4u (subscribe)","Boppity bibbity your breathing is now a concious activity","Here you leave the world of today, and enter the world of yesterday, tomorrow, and fantasy.",":D","Hello there","General kenobi","Over 1.5k lines of code!","We would like to contact your about your car's extended warranty","As seen on TV!","D\xe9j\xe0 vu!","It's here!","One of a kind!","Mobile compatible!","Exclusive!","NP is not in P!","Jeb_","Also try services!","There are no facts, only interpretations!","Made with CSS!","Made with JS!","0% Sugar!","The future is now!","Schol+ >>>","bea was here!","2024 exclusive!","Now with themes!","All I want for christmas is for you to wash your dishes","... But no one came.","You are filled with determination.","Hey you. You're finally awake","Thats an infix!","Did you spot it?","Was that the bite of '87???","150% hyperbole!","Any computer is a laptop if you're brave enough!","| || || |_","Complex cellular automata!","D\xe9j\xe0 vu!","Doesn't avoid double negatives!","doot doot","From the streets of Melbourne!","Ghoughpteighbteau tchoghs!","Bring me a shrubbery.","Dragon free!","Follows ventilation guidelines!","Breen should win the house cup!","Hughes should win the house cup!","Mitre should win the house cup!","Kilburn should win the house cup!","Sarum should win the house cup!","Look Mum! I'm a splash!","Meeting expectations!","Usually!","2345312!","The cake is a lie!","I'll show you how deep the rabbit hole goes!","duckawesome is not a cheat code!","Ctrl+Alt+Del your worries away!","Error 404: Splash not found!","Error 418: I'm a teapot!","Reality.exe has stopped working!","Glitch in the matrix detected!","Only 50c!","It's not a bug, it's a feature!","This splash text is a lie!","Ctrl+S to save this splash!","Roses are red, violets are blue, this splash text is random, and so are you!","Chipi chipi chapa chapa dubi dubi daba daba!","Just a splash town girl!","Every splash you take, I'll be watching you!","Press any key to continue!","Use W to walk!","Debugging... or maybe just bugging...","Still trying to find Wally!","Reality is just a crutch for people who can't handle video games!","A wild splash appeared!","To infinity and beyond!","That's what she said!","Have you turned it on and off again?","Keep your enemies close and your... wait","I'm on a boat!","Works at Sea (probably)!","Who lives in the console under the sea? Me!","Its me, Hi, I'm SchoLExtension, its me!","This is not a drill!","This is a drill!","I solemly swear I am up to no good!","That's what she coded!","Houston we have a problem!","Colourmatic!","0!=1","Solve sqrt(x+36) + sqrt(2x-33) = sqrt(6x+6) for x. Substitute the answer into the left hand side and evaluate, storing the result as y.\nOnce you are done, run the function iSolvedForX(x,y)! (Hint: sqrt(x) can be expressed in JS as Math.sqrt(x).)"],r=window.scholChromeExt?"[Development Enabled] ":"";splashIndex=Math.floor(Math.random()*n.length);let l="\n"+n[splashIndex];switch(l){case"\nDid you spot it?":console.log(r+"SchoL Extentions Loaded. %c"+l,"color: #fcfc74");break;case"\nColourmatic!":console.log(r+"SchoL Extensions Loaded. \n%cC%co%cl%co%cu%cr%cm%ca%ct%ci%cc!","color: #c73c3c","color: #c7663c","color: #d9bc55","color: #8fc74c","color: #4cc78e","color: #4cc7a2","color: #5e4cc7","color: #854cc7","color: #aa4cc7","color: #c74cbb","color: #c74c8a");break;default:console.log(r+"SchoL Extensions Loaded. %c"+l,"color: #fcfc74")}}